{"version":3,"sources":["../../src/use-editable.ts"],"names":["useControllableState","useUpdateEffect","ariaAttr","callAllHandlers","isEmpty","mergeRefs","normalizeEventKey","useCallback","useRef","useState","useEditable","props","onChange","onChangeProp","onCancel","onCancelProp","onSubmit","onSubmitProp","value","valueProp","isDisabled","defaultValue","startWithEditView","isPreviewFocusable","submitOnBlur","selectAllOnFocus","placeholder","onEdit","onEditProp","htmlProps","defaultIsEditing","Boolean","isEditing","setIsEditing","setValue","shouldUpdate","prev","next","prevValue","setPrevValue","inputRef","previewRef","editButtonRef","isInteractive","current","focus","select","event","target","onKeyDown","eventKey","keyMap","Escape","Enter","shiftKey","metaKey","action","preventDefault","isValueEmpty","getTabIndex","shouldHaveTabIndex","undefined","onBlur","getPreviewProps","ref","children","hidden","tabIndex","onFocus","getInputProps","disabled","getEditButtonProps","type","onClick","getSubmitButtonProps","getCancelButtonProps"],"mappings":"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","sourcesContent":["import { useControllableState, useUpdateEffect } from \"@chakra-ui/hooks\"\nimport {\n  ariaAttr,\n  callAllHandlers,\n  EventKeyMap,\n  isEmpty,\n  mergeRefs,\n  normalizeEventKey,\n  PropGetter,\n} from \"@chakra-ui/utils\"\nimport { ChangeEvent, useCallback, useRef, useState } from \"react\"\n\nexport interface UseEditableProps {\n  /**\n   * The value of the Editable in both edit & preview mode\n   */\n  value?: string\n  /**\n   * The initial value of the Editable in both edit & preview mode\n   */\n  defaultValue?: string\n  /**\n   * If `true`, the Editable will be disabled.\n   */\n  isDisabled?: boolean\n  /**\n   * If `true`, the Editable will start with edit mode by default.\n   */\n  startWithEditView?: boolean\n  /**\n   * If `true`, the read only view, has a `tabIndex` set to `0`\n   * so it can recieve focus via the keyboard or click.\n   * @default true\n   */\n  isPreviewFocusable?: boolean\n  /**\n   * If `true`, it'll update the value onBlur and turn off the edit mode.\n   * @default true\n   */\n  submitOnBlur?: boolean\n  /**\n   * Callback invoked when user changes input.\n   */\n  onChange?: (nextValue: string) => void\n  /**\n   * Callback invoked when user cancels input with the `Esc` key.\n   * It provides the last confirmed value as argument.\n   */\n  onCancel?: (previousValue: string) => void\n  /**\n   * Callback invoked when user confirms value with `enter` key or by blurring input.\n   */\n  onSubmit?: (nextValue: string) => void\n  /**\n   * Callback invoked once the user enters edit mode.\n   */\n  onEdit?: () => void\n  /**\n   * If `true`, the input's text will be highlighted on focus.\n   * @default true\n   */\n  selectAllOnFocus?: boolean\n  /**\n   * The placeholder text when the value is empty.\n   */\n  placeholder?: string\n}\n\n/**\n * React hook for managing the inline renaming of some text.\n *\n * @see Docs https://chakra-ui.com/components/useEditable\n */\nexport function useEditable(props: UseEditableProps = {}) {\n  const {\n    onChange: onChangeProp,\n    onCancel: onCancelProp,\n    onSubmit: onSubmitProp,\n    value: valueProp,\n    isDisabled,\n    defaultValue,\n    startWithEditView,\n    isPreviewFocusable = true,\n    submitOnBlur = true,\n    selectAllOnFocus = true,\n    placeholder,\n    onEdit: onEditProp,\n    ...htmlProps\n  } = props\n\n  const defaultIsEditing = Boolean(startWithEditView && !isDisabled)\n\n  const [isEditing, setIsEditing] = useState(defaultIsEditing)\n\n  const [value, setValue] = useControllableState({\n    defaultValue: defaultValue || \"\",\n    value: valueProp,\n    onChange: onChangeProp,\n    shouldUpdate: (prev, next) => prev !== next,\n  })\n\n  /**\n   * Keep track of the previous value, so if users\n   * presses `cancel`, we can revert to it.\n   */\n  const [prevValue, setPrevValue] = useState(value)\n\n  /**\n   * Ref to help focus the input in edit mode\n   */\n  const inputRef = useRef<HTMLInputElement>(null)\n  const previewRef = useRef<any>(null)\n\n  const editButtonRef = useRef<HTMLButtonElement>(null)\n\n  const isInteractive = !isEditing || !isDisabled\n\n  useUpdateEffect(() => {\n    if (!isEditing) {\n      editButtonRef.current?.focus()\n      return\n    }\n\n    if (selectAllOnFocus) {\n      inputRef.current?.select()\n    } else {\n      inputRef.current?.focus()\n    }\n\n    onEditProp?.()\n  }, [isEditing, onEditProp, selectAllOnFocus])\n\n  const onEdit = useCallback(() => {\n    if (isInteractive) {\n      setIsEditing(true)\n    }\n  }, [isInteractive])\n\n  const onCancel = useCallback(() => {\n    setIsEditing(false)\n    setValue(prevValue)\n    onCancelProp?.(prevValue)\n  }, [onCancelProp, setValue, prevValue])\n\n  const onSubmit = useCallback(() => {\n    setIsEditing(false)\n    setPrevValue(value)\n    onSubmitProp?.(value)\n  }, [value, onSubmitProp])\n\n  const onChange = useCallback(\n    (event: ChangeEvent<HTMLInputElement>) => {\n      setValue(event.target.value)\n    },\n    [setValue],\n  )\n\n  const onKeyDown = useCallback(\n    (event: React.KeyboardEvent) => {\n      const eventKey = normalizeEventKey(event)\n\n      const keyMap: EventKeyMap = {\n        Escape: onCancel,\n        Enter: (event) => {\n          if (!event.shiftKey && !event.metaKey) {\n            onSubmit()\n          }\n        },\n      }\n\n      const action = keyMap[eventKey]\n      if (action) {\n        event.preventDefault()\n        action(event)\n      }\n    },\n    [onCancel, onSubmit],\n  )\n\n  const isValueEmpty = isEmpty(value)\n\n  const getTabIndex = () => {\n    const shouldHaveTabIndex = isInteractive && isPreviewFocusable\n    return shouldHaveTabIndex ? 0 : undefined\n  }\n\n  const onBlur = useCallback(() => {\n    if (submitOnBlur) {\n      onSubmit()\n    }\n  }, [submitOnBlur, onSubmit])\n\n  const getPreviewProps: PropGetter = (props = {}, ref = null) => ({\n    ...props,\n    ref: mergeRefs(ref, previewRef),\n    children: isValueEmpty ? placeholder : value,\n    hidden: isEditing,\n    \"aria-disabled\": ariaAttr(isDisabled),\n    tabIndex: getTabIndex(),\n    onFocus: callAllHandlers(props.onFocus, onEdit),\n  })\n\n  const getInputProps: PropGetter = (props = {}, ref = null) => ({\n    ...props,\n    hidden: !isEditing,\n    placeholder,\n    ref: mergeRefs(ref, inputRef),\n    disabled: isDisabled,\n    \"aria-disabled\": ariaAttr(isDisabled),\n    value,\n    onBlur: callAllHandlers(props.onBlur, onBlur),\n    onChange: callAllHandlers(props.onChange, onChange),\n    onKeyDown: callAllHandlers(props.onKeyDown, onKeyDown),\n  })\n\n  const getEditButtonProps: PropGetter = (props = {}, ref = null) => ({\n    \"aria-label\": \"Edit\",\n    ...props,\n    type: \"button\",\n    onClick: callAllHandlers(props.onClick, onEdit),\n    ref: mergeRefs(ref, editButtonRef),\n  })\n\n  const getSubmitButtonProps: PropGetter = (props = {}, ref = null) => ({\n    ...props,\n    \"aria-label\": \"Submit\",\n    ref,\n    type: \"button\",\n    onClick: callAllHandlers(props.onClick, onSubmit),\n  })\n\n  const getCancelButtonProps: PropGetter = (props = {}, ref = null) => ({\n    \"aria-label\": \"Cancel\",\n    ...props,\n    ref,\n    type: \"button\",\n    onClick: callAllHandlers(props.onClick, onCancel),\n  })\n\n  return {\n    isEditing,\n    isDisabled,\n    isValueEmpty,\n    value,\n    onEdit,\n    onCancel,\n    onSubmit,\n    getPreviewProps,\n    getInputProps,\n    getEditButtonProps,\n    getSubmitButtonProps,\n    getCancelButtonProps,\n    htmlProps,\n  }\n}\n\nexport type UseEditableReturn = ReturnType<typeof useEditable>\n"],"file":"use-editable.js"}