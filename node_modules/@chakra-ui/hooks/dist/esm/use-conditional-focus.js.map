{"version":3,"sources":["../../src/use-conditional-focus.ts"],"names":["focus","getAllFocusable","React","useEventListener","useLatestRef","defaultOptions","preventScroll","shouldFocus","useConditionalFocus","target","options","focusRef","visible","element","current","autoFocus","onFocus","contains","document","activeElement","tabbableEls","length","onFocusRef","useEffect"],"mappings":"AAAA,SAASA,KAAT,EAAkCC,eAAlC,QAAyD,kBAAzD;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,gBAAT,QAAiC,sBAAjC;AACA,SAASC,YAAT,QAA6B,kBAA7B;AASA,IAAMC,cAA0C,GAAG;AACjDC,EAAAA,aAAa,EAAE,IADkC;AAEjDC,EAAAA,WAAW,EAAE;AAFoC,CAAnD;AAKA,OAAO,SAASC,mBAAT,CACLC,MADK,EAELC,OAFK,EAGL;AAAA,MADAA,OACA;AADAA,IAAAA,OACA,GADUL,cACV;AAAA;;AACA,MAAM;AAAEM,IAAAA,QAAF;AAAYL,IAAAA,aAAZ;AAA2BC,IAAAA,WAA3B;AAAwCK,IAAAA;AAAxC,MAAoDF,OAA1D;AACA,MAAMG,OAAO,GAAGJ,MAAM,IAAI,aAAaA,MAAvB,GAAgCA,MAAM,CAACK,OAAvC,GAAiDL,MAAjE;AAEA,MAAMM,SAAS,GAAGR,WAAW,IAAIK,OAAjC;;AAEA,MAAMI,OAAO,GAAG,MAAM;AACpB,QACE,CAACH,OAAD,IACA,CAACE,SADD,IAEAF,OAAO,CAACI,QAAR,CAAiBC,QAAQ,CAACC,aAA1B,CAFA,IAGAN,OAAO,KAAKK,QAAQ,CAACC,aAJvB,EAME;;AAEF,QAAIR,QAAJ,oBAAIA,QAAQ,CAAEG,OAAd,EAAuB;AACrBd,MAAAA,KAAK,CAACW,QAAQ,CAACG,OAAV,EAAmB;AAAER,QAAAA;AAAF,OAAnB,CAAL;AACD,KAFD,MAEO;AACL,UAAMc,WAAW,GAAGnB,eAAe,CAACY,OAAD,CAAnC;;AACA,UAAIO,WAAW,CAACC,MAAZ,GAAqB,CAAzB,EAA4B;AAC1BrB,QAAAA,KAAK,CAACoB,WAAW,CAAC,CAAD,CAAZ,EAAiB;AAAEd,UAAAA;AAAF,SAAjB,CAAL;AACD;AACF;AACF,GAjBD;;AAmBA,MAAMgB,UAAU,GAAGlB,YAAY,CAACY,OAAD,CAA/B;AAEAd,EAAAA,KAAK,CAACqB,SAAN,CAAgB,MAAM;AACpBD,IAAAA,UAAU,CAACR,OAAX;AACD,GAFD,EAEG,EAFH;AAIAX,EAAAA,gBAAgB,CAAC,eAAD,EAAkBa,OAAlB,EAA2BH,OAA3B,CAAhB;AACD","sourcesContent":["import { focus, FocusableElement, getAllFocusable } from \"@chakra-ui/utils\"\nimport * as React from \"react\"\nimport { useEventListener } from \"./use-event-listener\"\nimport { useLatestRef } from \"./use-latest-ref\"\n\nexport interface UseConditionalFocusOptions {\n  visible?: boolean\n  shouldFocus?: boolean\n  preventScroll?: boolean\n  focusRef?: React.RefObject<FocusableElement>\n}\n\nconst defaultOptions: UseConditionalFocusOptions = {\n  preventScroll: true,\n  shouldFocus: false,\n}\n\nexport function useConditionalFocus<T extends HTMLElement>(\n  target: React.RefObject<T> | T,\n  options = defaultOptions,\n) {\n  const { focusRef, preventScroll, shouldFocus, visible } = options\n  const element = target && \"current\" in target ? target.current : target\n\n  const autoFocus = shouldFocus && visible\n\n  const onFocus = () => {\n    if (\n      !element ||\n      !autoFocus ||\n      element.contains(document.activeElement) ||\n      element === document.activeElement\n    )\n      return\n\n    if (focusRef?.current) {\n      focus(focusRef.current, { preventScroll })\n    } else {\n      const tabbableEls = getAllFocusable(element)\n      if (tabbableEls.length > 0) {\n        focus(tabbableEls[0], { preventScroll })\n      }\n    }\n  }\n\n  const onFocusRef = useLatestRef(onFocus)\n\n  React.useEffect(() => {\n    onFocusRef.current()\n  }, [])\n\n  useEventListener(\"transitionend\", onFocus, element)\n}\n"],"file":"use-conditional-focus.js"}